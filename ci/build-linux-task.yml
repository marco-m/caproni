---
platform: linux
image_resource:
  type: docker-image
  source: {repository: marcomm/ready-to-build, tag: latest}
inputs:
  - name: caproni.git
  - name: version
outputs:
  - name: build
run:
  path: /bin/sh
  args:
    - -c
    - |
      set -o errexit
      set -o xtrace
      ls -1 -F
      echo "*** configure"
      cd build
      cmake ../caproni.git
      echo "*** build"
      cmake --build .
      ls -1 -F out
      echo "*** package"
      tar czf caproni-$(cat ../version/number).tgz out
